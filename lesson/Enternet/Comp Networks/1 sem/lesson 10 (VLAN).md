
# VLAN

### Определение, типы VLAN

![What_is_VLAN.png](png/lesson%2010/What_is_VLAN.png)

Как показано на рисунке, VLAN в коммутируемой сети позволяют пользователям различных отделов подключаться к одной и той
же сети независимо от используемого физического коммутатора или местоположения в локальной сети кампуса.

Если устройство в одной VLAN передает широковещательный кадр Ethernet, то этот кадр получают все устройства в рамках
этой VLAN, устройства в других сетях VLAN этот кадр не получают.

**Преимущества VLAN**:

* Мы добавляем иерархичность сети и повышаем производительность
* Снижение расходов на оборудовании (так бы пришлось приобрести для каждой сети отдельный коммутатор)
* Безопасность (Разделение на разные локальные сети ограничивает доступ разных пользователей друг от друга)
* Уменьшает размер широковещательного домена

Чтобы снизить нагрузку на оборудование (например при отправке широковещательного запроса - он приходит на все
подключенные порты, а создав несколько виртуальных сетей, мы сузим широковещательный домен, и теперь при отправке
широковещательного запроса он будет приходить только на тот VLAN, который ему предназначен)

#### типы VLAN

**Data VLAN**

Vlan для пользовательских данных, выделен для всех. *Vlan 1* уже является data

**Default VLAN** (*vlan 1*)

Существует на всех коммутаторах, можно перенастроить, все порты по умолчанию находятся в vlan 1

В Cisco есть еще 4 default vlan:

1002-1005 - достались в наследство, но они не используются

**VLAN native**

для помещения нетегироваемого трафика

**Management VLAN**

Vlan для управления, обычно настраивается специалистами.

**Voice VLAN** (*для голосового трафика VoIP*)

Vlan для голосового трафика рекомендуется отделять, чтобы далее создания приоритетов трафика.

### Добавление тега. Trunk-порты.

Основной принцип vlan в том что мы отдельные порты помещаем в отдельный созданный vlan, тем самым, говоря, что какие-то
пользователи будут находиться в 1 сети, а другие в другой.

Магистраль сетей VLAN (транк) — это двухточечный канал связи, который обслуживает более одной сети
VLAN.

![Trunk_Port.png](png/lesson%2010/Trunk_Port.png)

Стандарт IEEE 802.1Q добавляет 4-байтовый тег в кадр Ethernet для идентификации VLAN.
Шифрование вшито в протокол.

**Trunk-Порты**: Обеспечивают передачу трафика нескольких VLAN между коммутаторами. По умолчанию поддерживают все VLAN,
но можно ограничить список.

![Teg_Port.png](png/lesson%2010/Teg_Port.png)

**Тегированные порты** - они же **Магистральные**. На таких портах должны использоваться Native VLAN.

**switchport trunk encapsulation DOT1Q**  - включить информацию об id vlan в кадр Ethernet.

### Диапазоны VLAN: стандартные и расширенные.

#### Стандартные диапазоны

* Малые средние сети
* от 1 до 1005
* от 1002 до 1005 зарезервированные
* Конфигурация хранится на vlan.dat

#### Расширенные диапазоны

* Для больших сетей
* от 1006 до 4094
* Конфигурация хранится в running-config
* Нужны только если не хватает стандартного диапазона, т.к хранятся в текущей конфигурации.

### Маршрутизация между VLAN: способы, описание.

![Route_VLAN.png](png/lesson%2010/Route_VLAN.png)

Существуют три варианта маршрутизации между VLAN.

* Старый метод маршрутизации между VLAN - это устаревшее решение. Плохо масштабируется
* Router-on-a-Stick - это приемлемое решение для сети малых и средних размеров.
* Коммутатор уровня 3 с использованием коммутируемых виртуальных интерфейсов (SVI) — это наиболее масштабируемое решение
  для средних и крупных организаций.

**Старый метод маршрутизации между VLAN**

На коммутаторе создаем вланы и ставим порты в режим приема данных(access)

на маршрутизаторе настраиваем маршрутизацию
**int interface** **ip address address mask** **no sh**

**Router-on-a-Stick**

![Settings_Router_Stick.png](png/lesson%2010/Settings_Router_Stick.png)

**Коммутатор уровня 3 с SVI**

![Vlan_SVI.png](png/lesson%2010/Vlan_SVI.png)

### Многоуровневый коммутатор. Маршрутизация на многоуровневом коммутаторе

**Коммутатор уровня 3 с SVI**

![Vlan_SVI.png](png/lesson%2010/Vlan_SVI.png)

![Multilevel_Route_Vlan.png](png/lesson%2010/Multilevel_Route_Vlan.png)

Необходимо настроить коммутатор L3

![L3_Route.png](png/lesson%2010/L3_Route.png)

### Поиск и устранение неисправностей при работе с VLAN.

![Troubleshooting.png](png/lesson%2010/Troubleshooting.png)

### Настройка VLAN

**no switchport** - делает порт маршрутизируемым

![Vlan_Settings.png](png/lesson%2010/Vlan_Settings.png)

Кол-во настроенных влан:
![show_vlan_summary.png](png/lesson%2010/show_vlan_summary.png)