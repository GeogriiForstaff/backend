# Динамическая маршрутизация. Протокол OSPF

## Протоколы состояния канала

### Классификация

![class_routing.png](img/lesson6/class_routing.png)

### Алгоритм работы состояния канала

Задача протокола - обеспечить одинаковую информацию на всех маршрутизаторах, которые работают с этим протоколом
состояния канала

![link_state_protocol.png](img/lesson6/link_state_protocol.png)

Алгоритм:

1. Изучает подключенные сети
2. Каждый маршрутизатор выявляет своих соседей с помощью Hello сообщений и с помощью этих сообщений поддерживает
   связанность со своими соседями
3. После выяснения соседей каждый маршрутизатор рассылает пакет состояния канала (LSP)
4. Каждый маршрутизатор, который получил такой пакет, должен лавинно разослать его всем своим соседям
5. Каждый маршрутизатор заносит в свою базу данных, на основе этой БД строится топология сети и рассчитывается
   оптимальный маршрут

Рассмотрим на примере R1

![R1.png](img/lesson6/R1.png)

Отправка хэлоу сообщений

![Hello.png](img/lesson6/Hello.png)

Создастся 4 пакета LSP и КАЖДЫЙ пакет будет переслан всем соседям

![LSP.png](img/lesson6/LSP.png)

Далее Каждый маршрутизатор должен незамедлительно разослать этот LSP пакет дальше, т.е каждый маршрутизатор продублирует
на все свои настроенные интерфейсы полученный LSP пакет, кроме того интерфейса с которого был получен пакет. (Это и есть
лавинная рассылка)

Такой рассылкой мы гарантируем, что каждый маршрутизатор в топологии получит этот пакет.

![LSP2.png](img/lesson6/LSP2.png)

Все маршрутизаторы в топологии должны иметь одинаковую базу данных.

![LSD.png](img/lesson6/LSD.png)

SPF - алгоритм Дейкстры

![SPF_Tree.png](img/lesson6/SPF_Tree.png)

![table_route.png](img/lesson6/table_route.png)

### Приемущества и недостатки

![+_-.png](img/lesson6/%2B_-.png)

### Иерархия Протоколов состояния каналов

Протоколы состояния канала придерживаются иерархичность(разделению на области)

![Area.png](img/lesson6/Area.png)

В каждой области будет происходить полный процесс работы протокола, т.е только внутри какой-то области будет полностью
совпадать база данных

Между областями передается сокращенная информация, любое изменение в одной области не трегерит пересчет пути в других
областях, что экономит ресурсы ЦП

**!НО** только при правильном планировании иерархичности IP адресов возможна такая работа

### OSPF and IS-IS

![OSPF_IS-IS.png](img/lesson6/OSPF_IS-IS.png)

---------------------------------

## Принципы работы OSPF

## Настройка OSPF

## OSPFv3